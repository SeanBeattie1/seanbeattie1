<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Beep - Hack The Box Write-Up</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/style.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>
<body>
  <div class="container">
    <nav class="navbar">
  <ul class="nav-links">
    <li><a href="../index.html"><i class="fas fa-home"></i> Home</a></li>
    <li><a href="../index.html#about"><i class="fas fa-user"></i> About</a></li>
    <li><a href="../projects.html"><i class="fas fa-code"></i> Projects</a></li>
    <li><a href="../writeups.html"><i class="fas fa-file-alt"></i> Write-Ups</a></li>
    <li><a href="../index.html#contact"><i class="fas fa-envelope"></i> Contact</a></li>
  </ul>
    </nav>

    <div class="contents">
      <h1>Beep – HackTheBox WriteUp</h1>

      <div class="big-to-normal-image">
        <img src="../images/beep_banner1.png" alt="Beep Banner">
      </div>

      <p>This write-up focuses on the HackTheBox machine “Beep,” one of the machines from TJnull’s recommended list for OSCP preparation. I’m working through these machines to sharpen my penetration testing skills and prepare for the OSCP exam.</p>

      <h2>Enumeration</h2>
      <h3>Nmap Scan</h3>
      <p>The first step I took to tackle this machine was running an Nmap scan on the host. Once the scan completed, it revealed several interesting ports. I decided to focus my attention on ports 22, 80, 443, and 10000, as they seemed promising for further exploitation.</p>

      <div class="big-to-normal-image">
        <img src="../images/beep1.webp" alt="Nmap initial scan">
        <img src="../images/beep2.webp" alt="Nmap detailed results">
      </div>

      <h2>Ports 80 and 443</h2>
      <p>Next, I decided to examine ports 80 and 443. To access the website, I needed to adjust the TLS version in Firefox, as the site was using an older version than my browser’s current settings. I did this by typing about:config in the address bar and changing the security.tls.version.min setting to 1, allowing me to view the site.</p>

      <div class="big-to-normal-image">
        <img src="../images/beep3.webp" alt="Adjusting TLS settings in Firefox">
      </div>

      <p>After making the adjustment, I gained access to the homepage. I immediately noticed that the website was running Elastix, an open-source unified communications platform.</p>

      <div class="big-to-normal-image">
        <img src="../images/beep4.webp" alt="Elastix homepage">
      </div>

      <h2>Port 10000</h2>
      <p>I also decided to investigate port 10000 and was greeted by a Webmin login page. I made sure to take note of this, as it could be potentially useful later in the process.</p>

      <div class="big-to-normal-image">
        <img src="../images/beep5.webp" alt="Webmin login page">
      </div>

      <h2>Gobuster Scan</h2>
      <p>Next, I decided to perform some reconnaissance on the website to uncover any additional information. I ran a directory scan using Gobuster to identify directories that might contain sensitive data. Once the scan finished, I discovered some critical directories, including admin, as well as other potentially sensitive ones like modules and help.</p>

      <div class="big-to-normal-image">
        <img src="../images/beep6.webp" alt="Gobuster results">
      </div>

      <h2>Elastix LFI Exploit</h2>
      <p>I proceeded to explore the directories I had found, hoping to uncover any sensitive information, but unfortunately, nothing useful turned up. I then decided to search online for potential Elastix exploits. Almost immediately, I came across a Local File Inclusion (LFI) exploit for Elastix version 2.2.0, and decided to pursue that avenue.</p>

      <div class="big-to-normal-image">
        <img src="../images/beep7.webp" alt="Elastix LFI exploit details">
      </div>

      <p>The exploit details revealed that Elastix is vulnerable to a Local File Inclusion (LFI) attack due to improper sanitization of user-supplied input. An attacker can leverage this vulnerability to access files and execute local scripts with the privileges of the web server process.</p>

      <div class="big-to-normal-image">
        <img src="../images/beep8.webp" alt="Successful LFI retrieving credentials">
      </div>

      <p>When I attempted the exploit on the target host, I successfully retrieved a file which contained a list of usernames and passwords. Upon further inspection, I noticed that the website appeared to suffer from password reuse, indicating that all of the usernames likely shared the same password: jEhdIekWmdjE.</p>

      <div class="big-to-normal-image">
        <img src="../images/beep9.webp" alt="Elastix admin dashboard">
      </div>

      <h2>Elastix Dashboard Access</h2>
      <p>Next, I attempted to log in to the Elastix dashboard using the username admin and the password jEhdIekWmdjE. The login was successful, granting me access to the dashboard.</p>

      <div class="big-to-normal-image">
        <img src="../images/beep10.webp" alt="Elastix admin dashboard">
      </div>

      <h2>Webmin Access</h2>
      <p>The next step was to attempt privilege escalation. Unfortunately, I couldn’t find anything useful on the Elastix dashboard to assist with this. Then I remembered that I might also be able to access the Webmin panel on port 10000. After several attempts with different usernames, I successfully logged in using the username root and the same password, jEhdIekWmdjE.</p>

      <div class="big-to-normal-image">
        <img src="../images/beep11.webp" alt="Webmin dashboard">
      </div>

      <h2>Command Scheduling for Root</h2>
      <p>After exploring the Webmin panel, I discovered that I had many more options at my disposal. One of these options allowed me to schedule commands for any user, including root.</p>

      <div class="big-to-normal-image">
        <img src="../images/beep12.webp" alt="Scheduling command as root">
      </div>

      <h2>Reverse Shell</h2>
      <p>I then set up a listener on my local terminal and scheduled a reverse shell command I obtained from PentestMonkey to execute as the root user. This reverse shell would enable me to connect to the target through my local terminal, hopefully granting me root access.</p>

      <div class="big-to-normal-image">
        <img src="../images/beep13.webp" alt="Netcat listener">
        <img src="../images/beep14.webp" alt="Root reverse shell received">
      </div>

      <h2>User Flag</h2>
      <p>Once I obtained root access, I began exploring the directories and found the user flag located in /home/fanis/user.txt.</p>

      <div class="big-to-normal-image">
        <img src="../images/beep15.webp" alt="User flag">
      </div>

      <h2>Root Flag</h2>
      <p>I then located the root flag in /root/root.txt, successfully pwning the Beep machine!</p>

      <div class="big-to-normal-image">
        <img src="../images/beep16.webp" alt="Root flag">
        <img src="../images/beep17.webp" alt="Machine pwned">
      </div>
    </div>
  </div>
</body>
</html>
